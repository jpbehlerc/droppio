$(document).ready(function(){function e(){this._jsonified=[],this._keys=[],this.bloodType=!1,this.name=!1,this.lastname=!1,this.dni=!1,this.email=!1,this.weight=!1,this.birthDate=!1,this.password=!1,this.toJSON=function(){for(var e in this)-1==e.indexOf("_")&&this[e].length&&(this._jsonified[e]=this[e]);return this._jsonified}}function t(e){s.location={lat:e.coords.latitude,lon:e.coords.longitude}}var s=new e;navigator.geolocation.watchPosition(function(e){t(e)}),$.post("/registerTest",{_xsrf:xsrf_token,type:"creds"}).done(function(e){if(e=JSON.parse(e),respType=e.type,"creds"==respType){var t=e.dbUser,o=e.dbPass,i=new PouchDB("settings"+t,{auto_compaction:!1,cache:!1,heartbeat:!0}),n=new PouchDB("https://"+t+":"+o+"@alfredarg.com:6489/settings"+t);$("#saveSettings").submit(function(e){e.preventDefault(),s.name=$("#name").val(),s.lastname=$("#lastname").val(),s.bloodType=$("#bloodType").val(),s.dni=$("#dni").val(),s.email=$("#email").val(),s.birthDate=$("#birthDate").val(),s.weight=$("#weight").val(),s.password=$("#password").val(),s.radius=$("#radius").val(),elems=s.toJSON(),keys=Object.keys(elems),i.allDocs({include_docs:!0,keys:keys}).then(function(e){console.log(e.rows),e.rows.forEach(function(e){console.log(e),"error"in e&&console.log({id:e.key,value:elems[e.key]})})}).catch(function(e){})}),i.sync(n,{live:!0,retry:!0,back_off_function:function(e){return 0==e?1e3:e>=1e3&&e<18e5?1.5*e:e>=18e5?1.1*e:void 0}}).on("error",function(e){})}}),$(".datepicker").pickadate({selectMonths:!0,selectYears:15,today:"Today",clear:"Clear",close:"Ok",closeOnSelect:!1}),$("select").material_select()});